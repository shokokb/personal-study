# Security

## 盗聴

- 受信者にメッセージが到達するまで、鍵を用いて、メッセージを暗号化する
- 受信者がメッセージを受信したら、鍵を用いて、d メッセージを復号化する

## なりすまし

- 対策
  - メッセージ承認コード
  - デジタル署名

## 改ざん

- メッセージを書き換える＠
- 対策
  - メッセージ承認コード
  - デジタル署名

## 事後否認

- メッセージの送信を事後に否認する
- 対策
  - デジタル署名

---

# デジタル署名

- 公開鍵の保持者が特定できない問題を解決するために、デジタル証明書という技術もある

---

# ハッシュ関数

- データをハッシュ関数にかけて出力された値を「ハッシュ値」と呼ぶ
- ハッシュ関数の特徴
  - 出力値のデータ長は変わらない
  - 同じ入力値なら、同じ出力値が得られる
  - 類似データでも 1 ビット異なれば、出力が異なる
  - まれに、全く異なる入力に対して同じ出力が得られるハッシュ値の衝突が発生する
  - ハッシュ値から元の入力値を逆算することができない
- ハッシュ関数のアルゴリズム
  - MD5（安全性に問題あり）
  - SHA アルゴリズム(Secure Hash Algorithm)　文字列 → スロット番号
    - SHA-1...入力値に足し算やシフト演算を数百回繰り返すことでハッシュ値を生成する
    - SHA-2（主流）
- ユーザーアカウントの管理にもハッシュ関数が用いられる
  - パスワードの原本は保存せず、ハッシュ値を退避することにより、データが盗まれてもパスワードを復元できないようにする

---

# 共通鍵暗号方式

- 鍵配送問題
- 共通鍵を盗まれて復号される可能性がある
- 共通鍵暗号方式のアルゴリズム
  - シーザー暗号
  - AES（主流）
  - DES
  - ワンタイム・パッド
  - 共通鍵暗号の場合、やりとりする人数が増えると鍵の数はnC2=n(n-1)/2

---

# 公開鍵暗号方式

- 受信者には公開鍵と秘密鍵がある
- 受信者は送信者に公開鍵を送り、送信者は公開鍵で暗号化する
- 受信者はメッセージを秘密鍵で復号する
- 公開鍵暗号のアルゴリズム
- データが改竄されても、受信者は中身を見れないので、意味がない
- man-in-the-middle攻撃
  - 受信者が送信者に公開鍵を送るときにすり替える
  - 送信者は偽の公開鍵で暗号化する
  - 盗聴者は偽の秘密鍵で復号する
  - 盗聴者は元の受信者に本来の公開鍵で暗号化して送る
- 公開鍵暗号方式の問題点
  - 暗号化＆復号化に時間がかかる
  - 公開鍵の信頼性の問題→デジタル証明書
- 公開鍵暗号方式を実現する具体的なアルゴリズム
  - データのある数を使って暗号化でき、
  - 別の数を使って計算することにより元のデータに戻すことができ、
  - かつ、片方の鍵からもう片方の鍵を推測できないように演算できる必要がある
- 電子署名
  - 送信者の秘密鍵で暗号化し、送り手の公開鍵で承認する
  - 電子署名の使い回しは盗まれやすい。（ダイジェストを使う）
# ハイブリッド暗号方式
  

  - RSA 暗号
  - 楕円曲線暗号

- LS ハッシュ　似たようなデータを入れたときに似たようなスロット番号　 SlimHash
  　- クロールの類似、文書の類似

- ディフィーヘルマン鍵交換　メッセージを暗号化して、相手だけようにする
  　- 公開鍵・秘密鍵　 RSA が後継
